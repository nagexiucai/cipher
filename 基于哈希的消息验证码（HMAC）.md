即“HMAC（Hash-based MAC: Message Authentication Code）”。

- 输入长消息
- 输出固定长度
- 发送方用MAC签名消息
- 接收方用共享的密钥验证消息签名

用秘密前缀或秘密后缀的给消息做哈希。

秘密前缀：先是密钥、接下来是消息。

秘密后缀：先是消息、接下来是密钥。

# HMAC的高层设计

是信息的小部分或小算法，基本上用来验证消息，维持完整性、保证消息授权。

HMAC是衍生自密码学哈希函数，如MD5/SHA-1的消息验证码。

基本想法是给现有消息摘要算法增加一个密钥层。

即使攻击者获取到带盐的、哈希过的密码数据库，没有密钥，要破解数据仍有难度。

和MD5/SHA-1一样，该算法不依赖密钥，HMAC在IP安全已经是强制要实现的MAC。

HMAC可以和任何现有消息熵算法协作。

它将内嵌哈希函数产生的消息熵当作黑盒。

然后用分享的对称密钥加密消息熵，这样，产生最终输出，就是MAC。

HMAC是通过运用如MD5/SHA-1等密码学哈希函数对MAC的计算。

当用SHA-1，对应的MAC就是HMAC-SHA1，或用SHA-256，则是HMAC-SHA256。

将密钥保存在单独的位置，例如作为环境变量，而不是放在带盐的、哈希过的密码的数据库，是好的实践。